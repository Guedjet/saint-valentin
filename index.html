<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Pour toi ‚ù§Ô∏è</title>
<link href="https://fonts.googleapis.com/css2?family=Great+Vibes&family=Poppins:wght@300;500&display=swap" rel="stylesheet">

<style>
body{
  margin:0;
  height:100vh;
  overflow:hidden;
  font-family:'Poppins',sans-serif;
  background:linear-gradient(135deg,#ff758c,#ff7eb3);
  display:flex;
  justify-content:center;
  align-items:center;
  color:white;
  text-align:center;
}

/* COEURS */
.heart{
  position:absolute;
  animation:floatUp 6s linear infinite;
}
@keyframes floatUp{
  from{transform:translateY(100vh);opacity:1;}
  to{transform:translateY(-10vh);opacity:0;}
}

/* ENVELOPPE */
.envelope{
  width:420px;
  height:300px;
  background:white;
  position:relative;
  cursor:pointer;
  border-radius:15px;
  opacity:0;
  transition:1s;
  display:flex;
  justify-content:center;
  align-items:center;
  overflow:hidden;
}
.flap{
  position:absolute;
  width:100%;
  height:100%;
  background:#ff4d6d;
  clip-path:polygon(0 0,100% 0,50% 50%);
  transition:1s;
}
.open .flap{
  transform:rotateX(180deg);
  transform-origin:top;
}

/* MESSAGE */
.message{
  position:absolute;
  top:50%;
  left:50%;
  transform:translate(-50%,-50%);
  width:80%;
  max-height:70%;
  padding:10px;
  color:#ff4d6d;
  font-family:'Great Vibes',cursive;
  font-size:32px;
  text-align:center;
  opacity:0;
  transition:1s;
  overflow:auto;
  word-wrap:break-word;
}
.open .message{
  opacity:1;
}

/* GALERIE */
.gallery{
  position:fixed;
  top:0;
  left:0;
  width:100%;
  height:100%;
  background:rgba(0,0,0,0.85);
  display:flex;
  justify-content:center;
  align-items:center;
  flex-direction:column;
  opacity:0;
  pointer-events:none;
  transition:1s;
}

.polaroid{
  background:white;
  padding:10px 10px 40px 10px;
  border-radius:10px;
  position:absolute;
  transform:rotate(-10deg);
  animation:drop 1.5s ease forwards;
}

.polaroid img{
  max-width:300px;
  border-radius:8px;
}

@keyframes drop{
  from{transform:translateY(-300px) rotate(-20deg);opacity:0;}
  to{transform:translateY(0) rotate(0);opacity:1;}
}

/* FEU D'ARTIFICE */
.firework{
  position:absolute;
  width:5px;
  height:5px;
  background:white;
  border-radius:50%;
  animation:explode 1s ease-out forwards;
}
@keyframes explode{
  from{transform:scale(1);opacity:1;}
  to{transform:scale(20);opacity:0;}
}

/* TEXTE FINAL */
.finalMessage{
  color:white;
  font-family:'Great Vibes',cursive;
  font-size:40px;
  margin-top:30px;
  opacity:0;
  transition:2s;
}

/* ================= INTRO 3D ================= */

.intro{
  position:fixed;
  top:0;
  left:0;
  width:100%;
  height:100%;
  display:flex;
  flex-direction:column;
  justify-content:center;
  align-items:center;
  background:linear-gradient(135deg,#ff758c,#ff7eb3);
  z-index:10;
  animation:fadeOutIntro 2s ease 4s forwards;
}

.bouquet{
  font-size:120px;
  animation:pop3D 2s ease forwards;
}

.introText{
  font-family:'Great Vibes',cursive;
  font-size:50px;
  margin-top:20px;
  opacity:0;
  animation:fadeInText 2s ease 1s forwards;
}

@keyframes pop3D{
  0%{transform:scale(0) rotateX(90deg);}
  50%{transform:scale(1.3) rotateX(0);}
  100%{transform:scale(1);}
}

@keyframes fadeInText{
  from{opacity:0;}
  to{opacity:1;}
}

@keyframes fadeOutIntro{
  to{opacity:0;pointer-events:none;}
}

</style>
</head>

<body onclick="startMusic()">

<div class="intro" id="intro">
  <div class="bouquet">üíê</div>
  <div class="introText">Joyeuse Saint-Valentin ‚ù§Ô∏è</div>
</div>

<div class="envelope" onclick="openEnvelope(event)">
  <div class="flap"></div>
  <div class="message" id="typedText"></div>
</div>

<div class="gallery" id="gallery"></div>

<audio id="music" loop>
  <source src="https://cdn.pixabay.com/audio/2022/02/23/audio_d1718f2f63.mp3" type="audio/mpeg">
</audio>

<script>

let envelopeOpened = false;

/* MUSIQUE */
let musicStarted = false;
const music = document.getElementById("music");

function startMusic(){
  if(!musicStarted){
    music.play().catch(()=>{});
    musicStarted = true;
  }
}

/* COEURS */
function createHeart(){
  const heart=document.createElement("div");
  heart.className="heart";
  heart.innerHTML="‚ù§Ô∏è";
  heart.style.left=Math.random()*100+"vw";
  heart.style.fontSize=(15+Math.random()*20)+"px";
  document.body.appendChild(heart);
  setTimeout(()=>heart.remove(),6000);
}
setInterval(createHeart,300);

/* OUVERTURE ENVELOPPE */
const text="Mon amour... chaque jour avec toi est un cadeau ‚ù§Ô∏è";

function typeWriter(text,element,i=0){
  if(i<text.length){
    element.innerHTML+=text.charAt(i);
    setTimeout(()=>typeWriter(text,element,i+1),40);
  }else{
    setTimeout(showGallery,1200);
  }
}

function openEnvelope(e){

  if(envelopeOpened) return; // bloque les clics suivants
  envelopeOpened = true;

  e.stopPropagation();
  startMusic();

  const env=document.querySelector(".envelope");
  env.classList.add("open");
  env.style.cursor="default";

  typeWriter(text,document.getElementById("typedText"));
}

/* GALERIE */
const images=[
  "photo1.jpg",
  "photo2.jpg",
  "photo3.jpg",
  "photo4.jpg",
  "photo5.jpg",
  "photo6.jpg",
  "photo7.jpg",
  "photo8.jpg",
  "photo9.jpg",
  "photo10.jpg"
];

function showGallery(){
  const gallery=document.getElementById("gallery");
  gallery.style.opacity=1;
  gallery.style.pointerEvents="all";

  let index=0;

  function showNext(){
    if(index>=images.length){
      setTimeout(showFinal,1500);
      return;
    }

    const pol=document.createElement("div");
    pol.className="polaroid";

    // Position random
    function randomPositionAvoidCenter(){

      let x,y;
      const centerXmin = 35;
      const centerXmax = 65;
      const centerYmin = 30;
      const centerYmax = 70;
    
      do{
        x = Math.random()*90;
        y = Math.random()*80;
      }while(
        x > centerXmin && x < centerXmax &&
        y > centerYmin && y < centerYmax
      );
    
      return {x,y};
    }

    const pos = randomPositionAvoidCenter();
    pol.style.left = pos.x + "vw";
    pol.style.top = pos.y + "vh";

    // Rotation random
    const rotate = Math.random()*40 - 20;
    pol.style.transform = `rotate(${rotate}deg)`;

    pol.innerHTML=`<img src="${images[index]}">`;

    gallery.appendChild(pol);

    index++;
    setTimeout(showNext,800);
  }

  showNext();
}


/* FEU D'ARTIFICE + MESSAGE FINAL */
function randomColor(){
  return `hsl(${Math.random()*360}, 100%, 60%)`;
}

function showFinal(){

  for(let i=0;i<25;i++){
    const fw=document.createElement("div");
    fw.className="firework";
    fw.style.left=Math.random()*100+"vw";
    fw.style.top=Math.random()*100+"vh";
    fw.style.background=randomColor();
    document.body.appendChild(fw);
    setTimeout(()=>fw.remove(),1000);
  }

  const gallery=document.getElementById("gallery");
  const final=document.createElement("div");
  final.className="finalMessage";
  final.innerHTML="Je t‚Äôaime plus que tout üíñ";
  gallery.appendChild(final);

  setTimeout(()=>final.style.opacity=1,500);
}

/* ================= INTRO TRANSITION ================= */

window.addEventListener("load",()=>{
  setTimeout(()=>{
    document.getElementById("intro").style.display="none";
    document.querySelector(".envelope").style.opacity=1;
  },6000);
});

</script>
</body>
</html>




